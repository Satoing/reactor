## 使用shared_ptr管理共享资源

原来代码存在的问题：如果客户端在事件处理时断开连接，Channel接收到客户端断开连接的消息，将会析构Connection。而业务函数处理结束后需要使用Connection对象发送消息，就会存在操作野指针的情况。

解决方案：使用共享指针。销毁一个指针，Connection对象并未释放，就不是野指针了。

然后解决使用共享指针导致的问题：

1. 对方已经断开连接，发送消息没有意义。
2. Connection对象没有销毁，不会自动从红黑树上移除。需要手动移除，不然水平触发模式会一直触发EPOLLIN（对方断开连接）。

## 使用unique_ptr管理独享资源

1. 类自己拥有的资源用unique_ptr管理，或直接使用栈空间。
2. 不属于这个类，但会使用的资源，使用裸指针。